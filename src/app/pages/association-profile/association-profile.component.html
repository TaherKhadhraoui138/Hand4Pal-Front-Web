<div class="profile-container">
    <div class="container">
        <div class="profile-header">
            <h1>Association Profile</h1>
            <p>Manage your association's information and settings</p>
        </div>

        <div class="profile-grid">
            <!-- Sidebar Navigation -->
            <div class="profile-sidebar">
                <div class="user-brief" *ngIf="currentUser">
                    <div class="avatar-lg">{{ currentUser.firstName?.charAt(0) }}</div>
                    <div class="user-info">
                        <h3>{{ currentUser.firstName }}</h3>
                        <span>Member since {{ currentUser.createdAt | date:'yyyy' }}</span>
                    </div>
                </div>

                <nav class="profile-nav">
                    <a href="javascript:void(0)" class="nav-item" [class.active]="activeTab === 'info'"
                        (click)="setActiveTab('info')">
                        <span class="nav-icon">üè¢</span> Association Info
                    </a>
                    <a href="javascript:void(0)" class="nav-item" [class.active]="activeTab === 'donations'"
                        (click)="setActiveTab('donations')">
                        <span class="nav-icon">üíö</span> Donations Received
                    </a>
                    <a routerLink="/association-dashboard" class="nav-item">
                        <span class="nav-icon">üìä</span> Dashboard
                    </a>
                    <a routerLink="/create-campaign" class="nav-item">
                        <span class="nav-icon">‚ûï</span> Create Campaign
                    </a>
                    <a href="javascript:void(0)" class="nav-item text-danger" (click)="logout()">
                        <span class="nav-icon">üö™</span> Sign Out
                    </a>
                </nav>
            </div>

            <!-- Main Content -->
            <div class="profile-content">
                <!-- Alerts -->
                <div *ngIf="successMessage" class="alert alert-success">
                    {{ successMessage }}
                </div>
                <div *ngIf="errorMessage" class="alert alert-danger">
                    {{ errorMessage }}
                </div>

                <!-- Association Info Tab -->
                <div class="card" *ngIf="activeTab === 'info'">
                    <div class="card-header">
                        <h2>Association Information</h2>
                    </div>

                    <form [formGroup]="profileForm" (ngSubmit)="onUpdateProfile()" class="profile-form">
                        <div class="form-group">
                            <label>Association Name</label>
                            <input type="text" formControlName="firstName" placeholder="Enter association name">
                        </div>

                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" formControlName="email" placeholder="Contact email">
                        </div>

                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" formControlName="phone" placeholder="Phone number">
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary" [disabled]="isLoading">Save Changes</button>
                        </div>
                    </form>
                </div>

                <!-- Donations Received Tab -->
                <ng-container *ngIf="activeTab === 'donations'">
                    <ng-container *ngIf="{
                        donations: donations$ | async,
                        isLoading: isLoadingDonations$ | async,
                        totalReceived: totalReceived$ | async
                    } as state">
                        <div class="card">
                            <div class="card-header">
                                <h2>Donations Received</h2>
                                <p class="header-subtitle" *ngIf="state.donations && state.donations.length > 0">
                                    Total received: <strong>{{ formatCurrency(state.totalReceived || 0) }}</strong>
                                </p>
                            </div>

                            <!-- Loading State -->
                            <div class="donations-loading" *ngIf="state.isLoading">
                                <div class="spinner"></div>
                                <p>Loading donations...</p>
                            </div>

                            <!-- Empty State -->
                            <div class="donations-empty" *ngIf="!state.isLoading && (!state.donations || state.donations.length === 0)">
                                <div class="empty-icon">üíö</div>
                                <h3>No donations yet</h3>
                                <p>You haven't received any donations yet. Create campaigns to start receiving support!</p>
                                <a routerLink="/create-campaign" class="btn btn-primary">Create Campaign</a>
                            </div>

                            <!-- Donations List -->
                            <div class="donations-list" *ngIf="!state.isLoading && state.donations && state.donations.length > 0">
                                <div class="donation-item" *ngFor="let donation of state.donations">
                                    <div class="donation-icon">
                                        üíö
                                    </div>
                                    <div class="donation-info">
                                        <h4 class="donor-name">{{ getDonorName(donation) }}</h4>
                                        <p class="campaign-name">
                                            <a [routerLink]="['/association-campaigns', donation.campaignId]">
                                                {{ donation.campaign?.title || 'Campaign #' + donation.campaignId }}
                                            </a>
                                        </p>
                                        <p class="donation-date">{{ donation.donationDate | date:'MMM d, yyyy \'at\' h:mm a' }}</p>
                                    </div>
                                    <div class="donation-amount">
                                        {{ formatCurrency(donation.amount, donation.currency) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </ng-container>
            </div>
        </div>
    </div>
</div>