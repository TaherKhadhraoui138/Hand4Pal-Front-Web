<div class="admin-container">
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h3>Admin<span class="text-gradient">Panel</span></h3>
        </div>

        <nav class="sidebar-nav">
            <button class="nav-btn" [class.active]="activeTab === 'dashboard'" (click)="activeTab = 'dashboard'">
                <span class="icon">üìä</span> Dashboard
            </button>
            <button class="nav-btn" [class.active]="activeTab === 'users'" (click)="activeTab = 'users'">
                <span class="icon">üë•</span> Users
            </button>
            <button class="nav-btn" [class.active]="activeTab === 'campaigns'" (click)="activeTab = 'campaigns'">
                <span class="icon">üì¢</span> Campaigns
            </button>
            <button class="nav-btn" [class.active]="activeTab === 'associations'" (click)="activeTab = 'associations'">
                <span class="icon">üè¢</span> Associations
            </button>
            <button class="nav-btn" [class.active]="activeTab === 'comments'" (click)="activeTab = 'comments'">
                <span class="icon">üí¨</span> Comments
            </button>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <header class="top-bar">
            <h2>{{ activeTab | titlecase }}</h2>
            <div class="admin-profile">
                <span>Admin User</span>
                <div class="avatar-sm">A</div>
            </div>
        </header>

        <div class="content-area">
            <!-- Dashboard Overview -->
            <div *ngIf="activeTab === 'dashboard'" class="dashboard-grid">
                <div class="stat-card">
                    <h3>Total Users</h3>
                    <p class="stat-value">{{ users.length }}</p>
                    <span class="stat-trend positive">All Users</span>
                </div>
                <div class="stat-card">
                    <h3>Pending Associations</h3>
                    <p class="stat-value">{{ pendingAssociations.length }}</p>
                    <span class="stat-trend warning">Requires attention</span>
                </div>
                <div class="stat-card">
                    <h3>Active Campaigns</h3>
                    <p class="stat-value">{{ activeCampaigns.length }}</p>
                    <span class="stat-trend positive">Running</span>
                </div>
                <div class="stat-card">
                    <h3>Pending Campaigns</h3>
                    <p class="stat-value">{{ pendingCampaigns.length }}</p>
                    <span class="stat-trend warning">Awaiting review</span>
                </div>
            </div>

            <!-- Users Management -->
            <div *ngIf="activeTab === 'users'">
                <div class="table-actions">
                    <input type="text" [(ngModel)]="searchQuery" (input)="onSearch()" placeholder="Search users..."
                        class="search-input">
                </div>

                <div *ngIf="isLoading" class="loading-state">
                    Loading users...
                </div>

                <div *ngIf="!isLoading && users.length === 0" class="empty-state">
                    <p>No users found</p>
                </div>

                <div *ngIf="!isLoading && users.length > 0" class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Type</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let user of users">
                                <td>{{ user.userId }}</td>
                                <td>{{ user.firstName || '‚Äî' }} {{ user.lastName || '' }}</td>
                                <td>{{ user.email }}</td>
                                <td>{{ user.phone || '‚Äî' }}</td>
                                <td><span class="status-badge">{{ user.role }}</span></td>
                                <td>
                                    <button class="btn btn-danger btn-sm" (click)="onDeleteUser(user.userId)">
                                        Delete
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Associations Management -->
            <div *ngIf="activeTab === 'associations'">
                <div class="section-header">
                    <h3>Pending Associations</h3>
                    <p>Review and approve association registration requests</p>
                </div>

                <div *ngIf="isLoading" class="loading-state">
                    Loading pending associations...
                </div>

                <div *ngIf="!isLoading && pendingAssociations.length === 0" class="empty-state">
                    <p>No pending associations to review</p>
                </div>

                <div *ngIf="!isLoading && pendingAssociations.length > 0" class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Association Name</th>
                                <th>Owner Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Description</th>
                                <th>Address</th>
                                <th>Website</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let association of pendingAssociations">
                                <td>{{ association.id }}</td>
                                <td><strong>{{ association.associationName }}</strong></td>
                                <td>{{ association.ownerFirstName }} {{ association.ownerLastName }}</td>
                                <td>{{ association.email }}</td>
                                <td>{{ association.phone }}</td>
                                <td class="truncate">{{ association.description }}</td>
                                <td class="truncate">{{ association.address }}</td>
                                <td>
                                    <a *ngIf="association.webSite" [href]="association.webSite" target="_blank"
                                        class="link">
                                        Visit
                                    </a>
                                    <span *ngIf="!association.webSite">‚Äî</span>
                                </td>
                                <td class="actions">
                                    <button class="btn btn-success btn-sm"
                                        (click)="onApproveAssociation(association.id)" title="Approve">
                                        ‚úì Approve
                                    </button>
                                    <button class="btn btn-danger btn-sm" (click)="onRejectAssociation(association.id)"
                                        title="Reject">
                                        ‚úó Reject
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Campaigns Management -->
            <div *ngIf="activeTab === 'campaigns'">
                <div class="section-header">
                    <h3>Campaign Management</h3>
                    <p>Review, approve or reject campaign submissions</p>
                </div>

                <!-- Campaign Tabs -->
                <div class="campaign-tabs">
                    <button 
                        class="tab-btn" 
                        [class.active]="campaignTab === 'pending'"
                        (click)="campaignTab = 'pending'">
                        Pending ({{ pendingCampaigns.length }})
                    </button>
                    <button 
                        class="tab-btn" 
                        [class.active]="campaignTab === 'active'"
                        (click)="campaignTab = 'active'">
                        Active ({{ activeCampaigns.length }})
                    </button>
                </div>

                <div *ngIf="isCampaignsLoading" class="loading-state">
                    Loading campaigns...
                </div>

                <!-- Pending Campaigns -->
                <div *ngIf="!isCampaignsLoading && campaignTab === 'pending'">
                    <div *ngIf="pendingCampaigns.length === 0" class="empty-state">
                        <p>No pending campaigns to review</p>
                    </div>

                    <div *ngIf="pendingCampaigns.length > 0" class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Title</th>
                                    <th>Category</th>
                                    <th>Association</th>
                                    <th>Target Amount</th>
                                    <th>End Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let campaign of pendingCampaigns">
                                    <td>{{ campaign.id }}</td>
                                    <td><strong>{{ campaign.title }}</strong></td>
                                    <td><span class="category-badge">{{ getCategoryName(campaign.category) }}</span></td>
                                    <td>{{ getAssociationDisplayName(campaign) }}</td>
                                    <td>{{ formatCurrency(campaign.targetAmount) }}</td>
                                    <td>{{ campaign.endDate | date:'mediumDate' }}</td>
                                    <td class="actions">
                                        <button class="btn btn-success btn-sm" (click)="onApproveCampaign(campaign.id)" title="Approve">
                                            ‚úì Approve
                                        </button>
                                        <button class="btn btn-danger btn-sm" (click)="onRejectCampaign(campaign.id)" title="Reject">
                                            ‚úó Reject
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Active Campaigns -->
                <div *ngIf="!isCampaignsLoading && campaignTab === 'active'">
                    <div *ngIf="activeCampaigns.length === 0" class="empty-state">
                        <p>No active campaigns</p>
                    </div>

                    <div *ngIf="activeCampaigns.length > 0" class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Title</th>
                                    <th>Category</th>
                                    <th>Association</th>
                                    <th>Progress</th>
                                    <th>Target</th>
                                    <th>End Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let campaign of activeCampaigns">
                                    <td>{{ campaign.id }}</td>
                                    <td><strong>{{ campaign.title }}</strong></td>
                                    <td><span class="category-badge">{{ getCategoryName(campaign.category) }}</span></td>
                                    <td>{{ getAssociationDisplayName(campaign) }}</td>
                                    <td>
                                        <div class="progress-mini">
                                            <div class="progress-bar-mini">
                                                <div class="progress-fill-mini" 
                                                     [style.width.%]="(campaign.collectedAmount / campaign.targetAmount) * 100"></div>
                                            </div>
                                            <span>{{ ((campaign.collectedAmount / campaign.targetAmount) * 100) | number:'1.0-0' }}%</span>
                                        </div>
                                    </td>
                                    <td>{{ formatCurrency(campaign.targetAmount) }}</td>
                                    <td>{{ campaign.endDate | date:'mediumDate' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Comments Management -->
            <div *ngIf="activeTab === 'comments'" class="empty-state">
                <p>Comment management coming soon</p>
            </div>
        </div>
    </main>
</div>

<!-- Alert Modal -->
<app-alert-modal
    [isOpen]="alertModal.isOpen"
    [title]="alertModal.title"
    [message]="alertModal.message"
    [type]="alertModal.type"
    (closed)="closeAlert()">
</app-alert-modal>

<!-- Confirmation Modal -->
<app-alert-modal
    [isOpen]="confirmModal.isOpen"
    [title]="confirmModal.title"
    [message]="confirmModal.message"
    type="warning"
    [showCancel]="true"
    confirmText="Yes, proceed"
    cancelText="Cancel"
    (confirmed)="onConfirmAction()"
    (cancelled)="closeConfirm()"
    (closed)="closeConfirm()">
</app-alert-modal>